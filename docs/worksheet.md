# GPU AG - Worksheet

## Цель текущей фазы

Довести надёжность GPU DE до ~100% сходимости при минимальном увеличении времени.

**Baseline (из RND-777):**
- Zeros+noise init: 95% успеха, 2.1 сек
- GPU недоиспользуется (<1% мощности)

---

## [2025-12-17 20:00] Старт новой фазы

### План
1. Multi-population (3-15 штук) - измерить время и стабильность
2. Паттерная инициализация (тренды, дуги)
3. Monte Carlo инициализация
4. Тест на полной скважине

### Ожидания
- 3 популяции → ~99.99% успеха
- Время: 2.1 сек → ~3 сек (не критично)

---

## [2025-12-17 20:30] Эксперимент 1: Multi-population scaling

### Результаты

| N pops | Total | Time | Ratio | Best fun | Все нашли глобальный? |
|--------|-------|------|-------|----------|----------------------|
| 1 | 500 | 1.87s | 1.0x | 0.251 | НЕТ (локальный!) |
| 2 | 1000 | 2.67s | 1.4x | 0.155 | ДА |
| 3 | 1500 | 3.26s | 1.7x | 0.155 | ДА |
| 5 | 2500 | 4.66s | 2.5x | 0.155 | ДА |
| 10 | 5000 | 8.56s | 4.6x | 0.155 | ДА |
| 20 | 10000 | 16.37s | 8.8x | 0.155 | ДА |

### Выводы
1. **Масштабирование ~2x эффективнее линейного** (GPU параллелизм работает)
2. **N=1 с seed=42 застрял в локальном минимуме 0.25**
3. **N≥2 все популяции нашли глобальный 0.155**
4. **Рекомендация: N=3 даёт ~100% надёжность за 3.26 сек (+74% к базе)**

### Файл теста
`test_multi_de_scaling.py`

---

## [2025-12-17 21:00] Эксперимент 2: Reliability test (50 runs, N=10)

### Конфигурация
- 50 запусков
- 10 параллельных популяций
- 500 особей в каждой (5000 total)
- 500 итераций
- Target: fun < 0.20

### Результаты

| Метрика | Значение |
|---------|----------|
| **Success rate** | **100% (50/50)** |
| Best fun (все) | 0.154904 |
| Std | 0.000000 |
| Время/run | ~10 сек |
| Популяций → глобальный | 9.2/10 в среднем |

### Выводы
1. **100% надёжность достигнута!**
2. Даже когда 3/10 популяций застревают, остальные находят глобальный
3. 10 сек за 2.5M evaluations (5000×500)
4. Все 50 запусков нашли **точно одинаковый** минимум (std=0)

### Сравнение с baseline (RND-777)
| Конфигурация | Success | Время |
|--------------|---------|-------|
| 1 pop, zeros+noise | 95% | 2.1s |
| **10 pops, zeros+noise** | **100%** | **10s** |

### Файл теста
`test_multi_de_reliability.py`

---

## [2025-12-17 21:45] Интеграция multi-population DE в gpu_optimizer_fit

### Изменения
- Обновлён `gpu_optimizer_fit.py`:
  - Добавлена функция `run_multi_population_de()`
  - N=10 популяций по 500 особей
  - Zeros+noise инициализация
  - Island model (изолированные популяции)

### Конфигурация
```python
N_POPULATIONS = 10      # 10 параллельных популяций
POPSIZE_EACH = 500      # 500 особей в каждой
MAXITER = 500           # 500 итераций
```

### Тест
```
Time: 8.72s
Best fun: 0.154904
Pops found global: 9/10
```

### Интеграция со slicer
`slicer_gpu.py` автоматически использует обновлённый `gpu_optimizer_fit.py` через monkey-patch.

---

## Заметки

(записывать результаты экспериментов здесь)
